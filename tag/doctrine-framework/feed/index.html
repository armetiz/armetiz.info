<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Armetiz &#187; Doctrine</title>
	<atom:link href="http://www.armetiz.info/tag/doctrine-framework/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.armetiz.info</link>
	<description>Thomas Tourlourat - Ingénieur Informatique, CEO @Wozbe.com</description>
	<lastBuildDate>Mon, 01 Dec 2014 09:47:14 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.2.2</generator>
	<item>
		<title>Livre &#8211; MongoDB in Action</title>
		<link>http://www.armetiz.info/livre-mongodb-in-action/</link>
		<comments>http://www.armetiz.info/livre-mongodb-in-action/#comments</comments>
		<pubDate>Fri, 16 Mar 2012 10:38:14 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Livres]]></category>
		<category><![CDATA[Databases]]></category>
		<category><![CDATA[Découverte]]></category>
		<category><![CDATA[Doctrine]]></category>
		<category><![CDATA[Driver]]></category>
		<category><![CDATA[Java]]></category>
		<category><![CDATA[Libre]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[MySQL]]></category>
		<category><![CDATA[PHP]]></category>
		<category><![CDATA[RDBMS]]></category>
		<category><![CDATA[SGBDR]]></category>
		<category><![CDATA[SQL]]></category>
		<category><![CDATA[Transaction]]></category>

		<guid isPermaLink="false">http://www.armetiz.info/?p=2275</guid>
		<description><![CDATA[Je souhaitais approfondir MongoDB depuis un petit moment déjà. Et bien qu&#8217;il y ai suffisamment de ressource sur le site officiel, la lecture d&#8217;un ouvrage papier a toujours été pour.. <a href="http://www.armetiz.info/livre-mongodb-in-action/" class="readmore">read more</a>]]></description>
				<content:encoded><![CDATA[<p><a href="http://www.amazon.fr/MongoDB-Action-Kyle-Banker/dp/1935182870"><img src="http://www.armetiz.info/files/2012/03/mongodb-in-action1.png" alt="mongodb-in-action" width="150" height="188" class="size-full wp-image-2277 alignright" /></a>Je souhaitais approfondir <strong><a href="http://www.mongodb.org/">MongoDB</a></strong> depuis un petit moment déjà. Et bien qu&#8217;il y ai suffisamment de ressource sur le site officiel, la lecture d&#8217;un ouvrage papier a toujours été pour moi un luxe lors des <a href="http://www.armetiz.info/category/livres/">mes découvertes techniques</a>. </p>
<h3>MongoDB</h3>
<p>Pour commencer,<br />
C&#8217;est un serveur de base de donnée <strong>NoSQL</strong> stockant les données sous forme de <strong>Document</strong>.<br />
Contrairement à d&#8217;autres serveurs NoSQL comme Redis qui ne permet un acces aux données que par une clé unique, MongoDB permet d&#8217;acceder à un ou plusieurs Document via un <strong>système de requête</strong> pouvant utiliser des <strong>indexes</strong>.<br />
MongoDB c&#8217;est aussi un déploiement <strong>Haute Disponibilité</strong> simplifié par la Réplication, une répartition des données &#8211; <strong>Sharding</strong> &#8211; possible pour les projets d&#8217;envergures, du <strong>Map/Reduce</strong> et du stockage de fichier via <strong>GridFS</strong>.<br />
Bref, c&#8217;est une mine d&#8217;or pour les technophiles.</p>
<h3>Le livre</h3>
<p>Ce livre s&#8217;adresse à ceux souhaitant découvrir MongoDB, voici les différents chapitres</p>
<ul>
<li>A database for the modern web</li>
<li>MongoDB through the JavaScript shell</li>
<li>Writting programs using MongoDB</li>
<li><strong>Document-oriented data</strong></li>
<li><strong>Queries</strong> and aggregation</li>
<li><strong>Updates, atomic operations</strong>, and deletes</li>
<li>Indexing and query optimization</li>
<li><strong>Replication</strong></li>
<li>Sharding</li>
<li>Deployment and administration</li>
</ul>
<p>Il s&#8217;agit d&#8217;un <strong>ouvrage écrit en Anglais</strong> dans un registre légèrement plus soutenu que les autres livres techniques Anglais. Heureusement il ne s&#8217;agit pas d&#8217;un roman, on comprends donc assez facilement les messages que souhaite faire passer l&#8217;auteur.</p>
<p><a href="http://www.mongodb.org/"><img src="http://www.armetiz.info/files/2012/03/mongodb-115x1151.jpg" alt="mongodb" width="115" height="115" class="size-full wp-image-2286 alignleft" /></a>Dès les 50 premieres pages, j&#8217;ai été <strong>convaincu</strong> par cette &#8220;nouvelle&#8221; technologie !<br />
J&#8217;avais énormément de question sur la structure d&#8217;un projet MongoDB et la migration depuis un SGBDR.<br />
C&#8217;est là que les exemples sont très parlant et illustrent les problématiques qu&#8217;un développeur rencontra à coups sûr. On trouve réponse à de nombreuses questions concernant la conception d&#8217;un projet avec MongoDB.</p>
<p>La partie qui m&#8217;a un peu déçu concerne le<strong> Sharding sous MongoDB</strong>.<br />
Je m&#8217;attendais à une fonctionnalité simple à mettre en place alors qu&#8217;en fait, cela implique quelques contraintes sur les indexes, et alourdit de maniere significative l&#8217;administration.<br />
Au final, c&#8217;est moi qui avait un mauvais jugement, le Sharding étant une fonctionnalité tellement excellente pour les entreprises disposant d&#8217;un jeux de données colossale qu&#8217;il ne fallait pas s&#8217;attendre à une simple commande CLI. <em>De grands pouvoirs impliquent de grandes responsabilités !</em> </p>
<h3>Pour conclure</h3>
<p><strong>MongoDB</strong> a un avenir plus que certain au sein de nos SI. Il manque encore un peu de <strong>maturité</strong> à ce projet pour qu&#8217;il puisse s&#8217;imposer face à MySQL. Mais un jour on utilisera les <strong>SGBDR</strong> uniquement lorsque l&#8217;on aura des contraintes liées aux transactions ou à une propriété dédiée des nos SGBRD.</p>
<h3>Pour aller un peu plus loin</h3>
<p><a href="http://www.doctrine-project.org/"><img src="http://www.armetiz.info/files/2012/03/doctrine1.png" alt="doctrine" width="191" height="53" class="size-full wp-image-2285 alignright" /></a><br />
Si vous êtes développeur PHP, je vous recommande fortement la lecture du projet <a href="http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/">Doctrine MongoDB ODM</a>.<br />
Mon point de vue est qu&#8217;il s&#8217;agit d&#8217;un must have sur les projets MongoDB.<br />
Sans parler de la possibilité de faire du <strong>mapping vers des POJO</strong>, MongoDB ODM permet d&#8217;assembler deux collections liés par des références, et je vous laisse découvrir l&#8217;intérêt du <a href="http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/priming-references.html">priming</a> qui ne vous laissera surement pas de marbre.</p>
<p>Commander le livre sur <a href="http://www.amazon.fr/MongoDB-Action-Kyle-Banker/dp/1935182870">Amazon</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.armetiz.info/livre-mongodb-in-action/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Doctrine 2 &amp; i18n</title>
		<link>http://www.armetiz.info/doctrine-2-internationalization/</link>
		<comments>http://www.armetiz.info/doctrine-2-internationalization/#comments</comments>
		<pubDate>Fri, 14 Oct 2011 08:57:10 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Doctrine]]></category>
		<category><![CDATA[Zend]]></category>
		<category><![CDATA[Framework]]></category>
		<category><![CDATA[i18n]]></category>
		<category><![CDATA[Information]]></category>
		<category><![CDATA[Internationalisation]]></category>
		<category><![CDATA[Langue]]></category>
		<category><![CDATA[Monde]]></category>
		<category><![CDATA[Système]]></category>
		<category><![CDATA[Traduction]]></category>
		<category><![CDATA[Translation]]></category>

		<guid isPermaLink="false">http://www.armetiz.info/?p=2154</guid>
		<description><![CDATA[Doctrine 2 est dépourvu &#8211; en natif &#8211; de système de traduction. Grâce au système d&#8217;extension, des contributeurs dont certains membres de l&#8217;équipe de développement Doctrine ont développés Gedmo, un.. <a href="http://www.armetiz.info/doctrine-2-internationalization/" class="readmore">read more</a>]]></description>
				<content:encoded><![CDATA[<p><a href="http://www.armetiz.info/files/2011/10/dbal_icon1.png"><img src="http://www.armetiz.info/files/2011/10/dbal_icon1.png" alt="" width="75" height="75" class="alignright size-full wp-image-2162" /></a><strong>Doctrine 2</strong> est dépourvu &#8211; en natif &#8211; de système de traduction.<br />
Grâce au système d&#8217;extension, des contributeurs dont certains membres de l&#8217;équipe de développement Doctrine ont développés <a href="https://github.com/l3pp4rd/DoctrineExtensions">Gedmo</a>, un pack d&#8217;extension pour Doctrine.</p>
<p>Cette extension inclue :
<ul>
<li>Tree</li>
<li><strong>Translatable</strong></li>
<li>Sluggable</li>
<li>Timestampable</li>
<li>Loggable</li>
<li>Sortable</li>
</ul>
<p>Nous nous intéresserons à <strong>Translatable</strong> qui nous permettra de traduire nos données.</p>
<p>Travaillant avec le <strong>Framework Zend</strong>, les exemples seront orientés pour cette architecture, il est à noter que cela n&#8217;est pas un pré-requit et que cela fonctionnera avec ou sans Zend Framework.</p>
<h3>Fonctionnement</h3>
<p>Le module <strong>i18n</strong> de Gedmo fonctionne grâce à l&#8217;utilisation d&#8217;un table annexe contenant la traduction de certaines propriétés de vos Entités.<br />
La table de traduction contient donc <strong>le nom du champs traduite</strong>, <strong>la langue</strong>, <strong>la valeur</strong>, <strong>le type d&#8217;objet</strong> ainsi qu&#8217;une <strong>reference vers cet objet</strong>.</p>
<p>Par défaut, l&#8217;extension aura besoin de la table : <strong>ext_translations</strong><br />
Les champs suivant seront ainsi necessaire :</p>
<ul>
<li>id</li>
<li>content</li>
<li>field</li>
<li>locale</li>
<li>foreign_key</li>
<li>object_class</li>
</ul>
<p>Voici un jeu de donnée qui vous permettra de mieux comprendre l&#8217;utilisation de ce type de structure :</p>
<blockquote>
<ul>
<li>content : Un día me voy a comprar el mundo</li>
<li>field : title</li>
<li>locale : es_es</li>
<li>foreign_key : 3</li>
<li>object_class : EntityArticle</li>
</ul>
<ul>
<li>content : Un jour j&#8217;achèterai le monde</li>
<li>field : title</li>
<li>locale : fr_fr</li>
<li>foreign_key : 3</li>
<li>object_class : EntityArticle</li>
</ul>
<ul>
<li>content : Le monde semble être à l&#8217;agonie, que pouvons nous faire pour le sauver.</li>
<li>field : description</li>
<li>locale : fr_fr</li>
<li>foreign_key : 3</li>
<li>object_class : EntityArticle</li>
</ul>
</blockquote>
<p>A noter, que les données relatives à la langue par défaut de votre application sont stockés au sein de la table gerant directement votre entité.<br />
Par défaut, nous utilisons la langue &#8220;<strong>en_US</strong>&#8220;, ce qui signifie que la table <strong>ext_translations</strong> ne contiendra pas de traduction pour &#8220;en_US&#8221;.<br />
Dans mon exemple, ces données seront stockés dans la table &#8220;<strong>articles</strong>&#8221; de l&#8217;entité <strong>EntityArticle</strong></p>
<p>Ainsi, l&#8217;extension stockera l&#8217;ensemble des traductions de votre application au sein d&#8217;une même table.<br />
Attention, le champs &#8220;<strong>forien_key</strong>&#8221; ne correspond pas à une clé étrangère pour votre base de donnée relationnelle.<br />
Une des possibilités de l&#8217;extension consiste à pouvoir définir une table spécifique à la traduction d&#8217;une Entités, ainsi vous pourrez définir une vrai <strong>clé étrangère</strong> au sein de votre <strong>RDBMS</strong>.</p>
<h3>Exploitation</h3>
<p>Au niveau de l&#8217;exploitation des données,<br />
Vous définirez la langue utilisée au sein de votre application lors de l&#8217;execution, cela correspondra normalement à la langue de l&#8217;utilisateur.<br />
Il ne restera plus qu&#8217;a utiliser votre application comme vous en avez l&#8217;habitude.</p>
<p>Nous partons du principe que votre environnement Doctrine est correctement configuré et fonctionnel.</p>
<p>Voici la configuration minimum a définir :</p>
<div class="codecolorer-container php blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br /></div></td><td><div class="php codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #000088;">$classLoader</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DoctrineCommonClassLoader<span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'Gedmo'</span><span style="color: #339933;">,</span> APPLICATION_PATH <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/../library/'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$classLoader</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">register</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$config</span> &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DoctrineORMConfiguration<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$driverChain</span>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DoctrineORMMappingDriverDriverChain<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$entityDriver</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DoctrineORMMappingDriverXmlDriver <span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$translatableDriver</span> <span style="color: #339933;">=</span> <span style="color: #000088;">$config</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">newDefaultAnnotationDriver</span><span style="color: #009900;">&#40;</span> APPLICATION_PATH <span style="color: #339933;">.</span> <span style="color: #0000ff;">'/../library/DoctrineExtensions/Gedmo/Translatable/Entity'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$driverChain</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">addDriver</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$entityDriver</span><span style="color: #339933;">,</span> &nbsp; &nbsp; <span style="color: #0000ff;">'EntityArticle'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$driverChain</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">addDriver</span> <span style="color: #009900;">&#40;</span><span style="color: #000088;">$translatableDriver</span><span style="color: #339933;">,</span> &nbsp; <span style="color: #0000ff;">'GedmoTranslatable'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$config</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">setMetadataDriverImpl</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$driverChain</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$eventManager</span> &nbsp; &nbsp; &nbsp; <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DoctrineCommonEventManager<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$translatableListener</span> &nbsp; <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> GedmoTranslatableTranslationListener<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
<span style="color: #000088;">$translatableListener</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">setTranslationFallback</span><span style="color: #009900;">&#40;</span> <span style="color: #009900; font-weight: bold;">true</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$eventManager</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">addEventSubscriber</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$translatableListener</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<br />
<span style="color: #000088;">$entityManager</span> <span style="color: #339933;">=</span> DoctrineORMEntityManager<span style="color: #339933;">::</span><span style="color: #004000;">create</span><span style="color: #009900;">&#40;</span><span style="color: #000088;">$conn</span><span style="color: #339933;">,</span> <span style="color: #000088;">$config</span><span style="color: #339933;">,</span> <span style="color: #000088;">$eventManager</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></div></td></tr></tbody></table></div>
<p>Ensuite, il faut configurer vos entités.<br />
J&#8217;utilise le XML Mapping, vous trouverez facilement l&#8217;équivalence pour YAML / Annotation.</p>
<div class="codecolorer-container xml blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br /></div></td><td><div class="xml codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">&nbsp;</div></td></tr></tbody></table></div>
<p>Nous avons simplement ajouté le noeud XML <strong>gedmo:translatable</strong> à notre champs afin de spécifier que celui-ci peut-être traduit.<br />
A noter qu&#8217;il faut inclure l&#8217;espace de nom <strong>xmlns:gedmo</strong>.</p>
<p>Voici un exemple d&#8217;utilisation avec Doctrine</p>
<div class="codecolorer-container php blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br /></div></td><td><div class="php codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #666666; font-style: italic;">//En utilisant la langue par défaut qui est l'anglais,</span><br />
<span style="color: #000088;">$article</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$entityManager</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">find</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'EntityArticle'</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$article</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getTitle</span> <span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #666666; font-style: italic;">//One day I'll buy the world</span><br />
<br />
<span style="color: #666666; font-style: italic;">//En spécifiant la langue espagnole,</span><br />
<span style="color: #000088;">$translatableListener</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">setTranslatableLocale</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;es_es&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$article</span> &nbsp; &nbsp;<span style="color: #339933;">=</span> <span style="color: #000088;">$entityManager</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">find</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'EntityArticle'</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><br />
<span style="color: #000088;">$article</span><span style="color: #339933;">-&gt;</span><span style="color: #004000;">getTitle</span> <span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <br />
<span style="color: #666666; font-style: italic;">//Un día me voy a comprar el mundo</span></div></td></tr></tbody></table></div>
<h3>Entity de traduction</h3>
<p>Nous avons vu précédemment que les traductions sont par défaut stockées dans la table <strong>ext_translations</strong>.<br />
Voyons comment utiliser une table dédiée à la traduction d&#8217;une entité. Cela permettra en plus d&#8217;avoir une structure de base de donnée plus propre, et d&#8217;avoir des clés étrangère au sein de votre RDBMS.</p>
<div class="codecolorer-container xml blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br /></div></td><td><div class="xml codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">&nbsp; &nbsp; &nbsp; &nbsp; ..</div></td></tr></tbody></table></div>
<p>Créons la class ArticleTranslation qui n&#8217;a rien de bien extraordinaire, sauf qu&#8217;elle doit étendre AbstractTranslation qui va définir les differentes propriétés de votre table de traduction.</p>
<div class="codecolorer-container php blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br /></div></td><td><div class="php codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap"><span style="color: #000000; font-weight: bold;">namespace</span> Entity<br />
<br />
<span style="color: #000000; font-weight: bold;">use</span> GedmoTranslatableEntityAbstractTranslation<span style="color: #339933;">;</span><br />
<span style="color: #000000; font-weight: bold;">use</span> DoctrineORMMapping <span style="color: #b1b100;">as</span> ORM<span style="color: #339933;">;</span><br />
<br />
<span style="color: #000000; font-weight: bold;">class</span> ArticleTranslation <span style="color: #000000; font-weight: bold;">extends</span> AbstractTranslation<br />
<span style="color: #009900;">&#123;</span><br />
&nbsp; &nbsp; <br />
<span style="color: #009900;">&#125;</span></div></td></tr></tbody></table></div>
<p>A cela, ajoutons le fichier de mapping.</p>
<div class="codecolorer-container php blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br /></div></td><td><div class="php codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">&nbsp;</div></td></tr></tbody></table></div>
<p>Il ne vous reste plus qu&#8217;a créer la table article_translation avec les champs énuméré en début d&#8217;article.</p>
<h3>Conclusion</h3>
<p>Comparer à Doctrine 1, la mise en place de l&#8217;internationalisation pour votre application peut sembler plus difficile. Par contre, l&#8217;exploitation de cette implementation est tout simplement <strong>user-friendly</strong>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.armetiz.info/doctrine-2-internationalization/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Ordonner les resultats Doctrine avec une table de composition</title>
		<link>http://www.armetiz.info/ordonner-resultats-doctrine-table-liaison/</link>
		<comments>http://www.armetiz.info/ordonner-resultats-doctrine-table-liaison/#comments</comments>
		<pubDate>Tue, 01 Jun 2010 06:00:59 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Doctrine]]></category>
		<category><![CDATA[Astuce]]></category>
		<category><![CDATA[DOM]]></category>
		<category><![CDATA[DQL]]></category>
		<category><![CDATA[Ordre]]></category>

		<guid isPermaLink="false">http://www.armetiz.info/?p=1716</guid>
		<description><![CDATA[Prenons le schéma ci-dessus. Au niveau de la définition, nous avons deux entités : Bureau ( rooms ) et Utilisateur ( users ). Ces deux entités sont liées par une.. <a href="http://www.armetiz.info/ordonner-resultats-doctrine-table-liaison/" class="readmore">read more</a>]]></description>
				<content:encoded><![CDATA[<p><a href="http://www.armetiz.info/files/2010/05/composition1.png"><img src="http://www.armetiz.info/files/2010/05/composition1.png" alt="" width="333" height="69" class="aligncenter size-full wp-image-1717" /></a></p>
<p>Prenons le schéma ci-dessus.<br />
Au niveau de la définition, nous avons deux entités : <strong>Bureau </strong>( rooms ) et <strong>Utilisateur </strong>( users ). Ces deux entités sont liées par une relation <strong>manyToMany </strong>car un utilisateur peut avoir plusieurs bureaux, et un bureau peut avoir plusieurs utilisateurs.<br />
Pour pouvoir intégrer l&#8217;ordonnancement des utilisateurs au sein d&#8217;une pièce, nous avons ajouté le champs &#8220;<strong>index</strong>&#8221; sur la table de liaison.</p>
<p>Grâce à cette définition, nous pouvons avoir les cas suivants :<br />
&#8211; Robert est à la place #2 dans le bureau d&#8217;accueil<br />
&#8211; Robert est à la place #1 dans le bureau du président<br />
&#8211; Annie est à la place #1 dans le bureau du président</p>
<h3>Définition des Domain Model Object</h3>
<p><a href="http://www.armetiz.info/files/2010/05/doctrine1.gif"><img src="http://www.armetiz.info/files/2010/05/doctrine1.gif" alt="doctrine" width="191" height="53" class="alignright size-full wp-image-1710" /></a><br />
Nous allons maintenant définir les liaisons Doctrine entre ces objets.<br />
Je n&#8217;utiliserai pas la définition YAML.</p>
<div class="codecolorer-container text blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />69<br />70<br />71<br />72<br />73<br />74<br />75<br />76<br />77<br />78<br />79<br />80<br />81<br />82<br />83<br />84<br />85<br />86<br />87<br />88<br />89<br />90<br />91<br />92<br />93<br />94<br />95<br />96<br />97<br />98<br />99<br />100<br />101<br />102<br />103<br />104<br />105<br />106<br />107<br />108<br />109<br />110<br />111<br /></div></td><td><div class="text codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">abstract class Model_Base_Room extends Model_Base<br />
{<br />
&nbsp; &nbsp; public function setTableDefinition()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;setTableName('rooms');<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('id_room as idRoom', 'integer', 4, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'integer',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '4',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('title', 'string', 80, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'string',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'notnull' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '80',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; }<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; public function setUp()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; parent::setUp();<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasMany('Model_User as users', array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'refClass' =&amp;gt; 'Model_CompoRoomsUsers',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'local' =&amp;gt; 'id_room',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'foreign' =&amp;gt; 'id_user'));<br />
&nbsp; &nbsp; }<br />
}<br />
<br />
abstract class Model_Base_User extends Model_Base<br />
{<br />
&nbsp; &nbsp; public function setTableDefinition()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;setTableName('users');<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('id_user as idUser', 'integer', 4, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'integer',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '4',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('firstname', 'string', 80, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'string',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'notnull' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '80',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; }<br />
&nbsp; &nbsp; <br />
&nbsp; &nbsp; public function setUp()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; parent::setUp();<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasMany('Model_Room as rooms', array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'refClass' =&amp;gt; 'Model_CompoRoomsUsers',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'local' =&amp;gt; 'id_user',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'foreign' =&amp;gt; 'id_room'));<br />
&nbsp; &nbsp; }<br />
}<br />
<br />
abstract class Model_Base_CompoRoomsUsers extends Model_Base<br />
{<br />
&nbsp; &nbsp; public function setTableDefinition()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;setTableName('compo_rooms_users');<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('id_room as idRoom', 'integer', 4, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'integer',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '4',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('id_user as idUser', 'integer', 4, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'integer',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '4',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasColumn('index', 'integer', 4, array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'type' =&amp;gt; 'integer',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'fixed' =&amp;gt; 0,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'unsigned' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'primary' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'notnull' =&amp;gt; true,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'autoincrement' =&amp;gt; false,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'length' =&amp;gt; '4',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;));<br />
&nbsp; &nbsp; }<br />
<br />
&nbsp; &nbsp; public function setUp()<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasOne('Model_User as user', array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'local' =&amp;gt; 'id_user',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'foreign' =&amp;gt; 'id_user'));<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; $this-&amp;gt;hasOne('Model_Room as room', array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'local' =&amp;gt; 'id_room',<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'foreign' =&amp;gt; 'id_room'));<br />
&nbsp; &nbsp; }<br />
}</div></td></tr></tbody></table></div>
<h3>Ordonner avec DQL</h3>
<p>Après cette longue définition, nous pouvons passer au code DQL qui permettra d&#8217;ordonner les résultats en fonction de l&#8217;index de notre table de liaison.</p>
<div class="codecolorer-container text blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br /></div></td><td><div class="text codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">$query&nbsp; = Doctrine_Query::create ()<br />
&nbsp; &nbsp; -&amp;gt;select (&quot;room.*, users.*&quot;)<br />
&nbsp; &nbsp; -&amp;gt;from (&quot;Model_Room room&quot;)<br />
&nbsp; &nbsp; -&amp;gt;leftJoin (&quot;room.users users&quot;)<br />
&nbsp; &nbsp; -&amp;gt;orderBy (&quot;room.id_room, users.Model_CompoRoomsUsers.index ASC&quot;);</div></td></tr></tbody></table></div>
<p>Prenez note du fait que nous trions dans un premier temps par identifiant de bureau et ensuite par index. Si nous n&#8217;utilisions qu&#8217;un tri par index, l&#8217;ordre des bureaux serai incohérent.</p>
<h3>Pour aller plus loin</h3>
<p>Nous avons décrit le fonctionnement pour ordonner des résultats à partir d&#8217;une table de liaison.<br />
Mais vous pouvez aussi utiliser cette méthode pour conditionner le résultat.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.armetiz.info/ordonner-resultats-doctrine-table-liaison/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Transfer Object Assembler avec Doctrine 1</title>
		<link>http://www.armetiz.info/transfer-object-assembler-avec-doctrine-1/</link>
		<comments>http://www.armetiz.info/transfer-object-assembler-avec-doctrine-1/#comments</comments>
		<pubDate>Mon, 31 May 2010 10:06:12 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Doctrine]]></category>
		<category><![CDATA[Zend]]></category>
		<category><![CDATA[AMF]]></category>
		<category><![CDATA[DBAL]]></category>
		<category><![CDATA[DTO]]></category>
		<category><![CDATA[Framework]]></category>
		<category><![CDATA[Konbini]]></category>
		<category><![CDATA[ORM]]></category>
		<category><![CDATA[Pattern]]></category>

		<guid isPermaLink="false">http://www.armetiz.info/?p=1693</guid>
		<description><![CDATA[Le pattern Transfert Object TO, Data Transfert Object DTO, ou encore Value Object VO permet d&#8217;échanger des données entre deux applications. Wikipédia : Son but est de simplifier les transferts.. <a href="http://www.armetiz.info/transfer-object-assembler-avec-doctrine-1/" class="readmore">read more</a>]]></description>
				<content:encoded><![CDATA[<p><a href="http://www.armetiz.info/files/2010/05/doctrine1.gif"><img src="http://www.armetiz.info/files/2010/05/doctrine1.gif" alt="doctrine" width="191" height="53" class="alignright size-full wp-image-1710" /></a>Le <a href="http://java.sun.com/blueprints/corej2eepatterns/Patterns/TransferObject.html">pattern Transfert Object</a> <strong>TO</strong>, <strong>Data Transfert Object DTO</strong>, ou encore <strong>Value Object VO</strong> permet d&#8217;échanger des données entre deux applications.</p>
<p>Wikipédia : <em>Son but est de simplifier les transferts de données entre les sous-systèmes d&#8217;une application logiciel. Les objets de transfert de données sont souvent utilisés en conjonction des objets d&#8217;accès aux données.</em></p>
<p>Qui dit <strong>Transfert Object</strong>, veux aussi dire <a href="http://java.sun.com/blueprints/corej2eepatterns/Patterns/TransferObjectAssembler.html">Transfert Object Assembler</a>. </p>
<h3>Conversion d&#8217;object</h3>
<p>Le pattern <strong>Transfert Object Assembler</strong> permet de passer d&#8217;un DTO à un Objet d&#8217;accès au données, et inversement.<br />
C&#8217;est le moyen le plus simple pour travailler avec le pattern Data Transert Object et un <strong>ORM</strong>.</p>
<h3>Domain Object Model -&gt; Data Transfert Object</h3>
<p>Avec l&#8217;<a href="http://www.doctrine-project.org/">ORM Doctrine</a>, le transfert d&#8217;un &#8220;<strong>Domain Object Model DOM</strong>&#8221; ou ici <strong>Doctrine_Record</strong> vers un <strong>DTO</strong> est très simple.<br />
Il suffit de réaliser un parser qui analyse l&#8217;objet issu de Doctrine, et qui remplit les données du DTO.</p>
<h3>Data Transfert Object -&gt; Domain Object Model</h3>
<p>Convertir un DTO vers un DOM peut s&#8217;avère plus complexe.<br />
En effet, Doctrine utilise des collections d&#8217;objet qui lui sont propres, mais a aussi besoin de connaitre les clés primaires et leurs contenus pour pouvoir créer un objet. Car un objet issu de Doctrine_Record n&#8217;a pas les même propriétés quand il est existant en base de donnée, ou qu&#8217;il est en phase d&#8217;être sauvegardé.</p>
<h3>Implémentation de Transfer Object Assembler</h3>
<p>Une implémentation du pattern <strong>Transfert Object Assembler</strong> vient de voir le jour après moult et moult péripéties.</p>
<p>Cette implémentation permet donc le transférer de DTOs à partir de DOMs et inversement.<br />
Associer au pattern Service Layer, cela peut s&#8217;avérer être très pratique.</p>
<p>Voici un exemple simple d&#8217;utilisation :</p>
<div class="codecolorer-container text blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br /></div></td><td><div class="text codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">$oProgram = new ProgramDTO ();<br />
$oProgram-&amp;gt;title = &quot;Dorothe&quot;;<br />
<br />
$oVideoDTO = new VideoDTO ();<br />
$oVideoDTO-&amp;gt;idVideo = 30;<br />
$oVideoDTO-&amp;gt;program = $oProgram;<br />
<br />
$oAssembler = $new Assembler ();<br />
$oVideo = $oAssembler-&amp;gt;createDomainObject ($oVideoDTO);<br />
$oVideo-&amp;gt;save ();</div></td></tr></tbody></table></div>
<p>Nous avons ici créé une nouvelle entrée dans la table programs, et réalisé une liaison entre ce nouvel objet et la vidéo existante d&#8217;identifiant 30.<br />
Le tout one-shot !</p>
<p>L&#8217;intérêt de cette implémentation, c&#8217;est d&#8217;être fonctionnel avec :</p>
<ul>
<li>Les objets persistant</li>
<li>Les objets non-persistant</li>
<li>Les compositions d&#8217;objets sur N niveau</li>
</ul>
<h3>Utilisation avec le pattern Service Layer</h3>
<p>Nous allons voir l&#8217;exemple le plus simple, soit l&#8217;implémentation des méthodes CRUD pour un objet générique.<br />
L&#8217;utilisation du nommage des classes provient de l&#8217;utilisation de Zend Framework.</p>
<div class="codecolorer-container text blackboard" style="overflow:auto;white-space:nowrap;border:1px solid #9F9F9F;width:435px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:5px;text-align:center;color:#888888;background-color:#EEEEEE;border-right: 1px solid #9F9F9F;font: normal 12px/1.4em Monaco, Lucida Console, monospace;"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br /></div></td><td><div class="text codecolorer" style="padding:5px;font:normal 12px/1.4em Monaco, Lucida Console, monospace;white-space:nowrap">/**<br />
&nbsp;* @param Model_DTO_Video<br />
&nbsp;* @return Model_DTO_Video<br />
&nbsp;*/<br />
public function create (Model_DTO_Video $poVideoDTO)<br />
{<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; &nbsp; &nbsp; = null;<br />
&nbsp; &nbsp; $oAssembler &nbsp; &nbsp; = new Model_Utils_Assembler ();<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; &nbsp; &nbsp; = $oAssembler-&amp;gt;createDomainObject($poVideoDTO, true);<br />
&nbsp; &nbsp; $oModelVideo-&amp;gt;save ();<br />
&nbsp; &nbsp; $poVideoDTO-&amp;gt;idShow&nbsp; = $oModelVideo-&amp;gt;idShow;<br />
&nbsp; &nbsp; return $poVideoDTO;<br />
}<br />
<br />
/**<br />
&nbsp;* @param Model_DTO_Video<br />
&nbsp;* @return Model_DTO_Video<br />
&nbsp;*/<br />
public function read (Model_DTO_Video $poVideoDTO)<br />
{<br />
&nbsp; &nbsp; $query&nbsp; = Doctrine_Query::create ()<br />
&nbsp; &nbsp; &nbsp; &nbsp; -&amp;gt;select (&quot;video.*&quot;)<br />
&nbsp; &nbsp; &nbsp; &nbsp; -&amp;gt;from (&quot;Model_Video video&quot;)<br />
&nbsp; &nbsp; &nbsp; &nbsp; -&amp;gt;where (&quot;video.id_show = ?&quot;, $piIdVideo);<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; = $query-&amp;gt;fetchOne ();<br />
&nbsp; &nbsp; $oAssembler = new Model_Utils_Assembler ();<br />
&nbsp; &nbsp; return $oAssembler-&amp;gt;createTransfertObject ($oModelVideo);<br />
}<br />
<br />
/**<br />
&nbsp;* @param Model_DTO_Video<br />
&nbsp;* @return Model_DTO_Video<br />
&nbsp;*/<br />
public function update (Model_DTO_Video $poVideoDTO)<br />
{<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; = null;<br />
&nbsp; &nbsp; $oAssembler = new Model_Utils_Assembler ();<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; = $oAssembler-&amp;gt;createDomainObject($poVideoDTO, true);<br />
&nbsp; &nbsp; $oModelVideo-&amp;gt;save ();<br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; return $poVideoDTO;<br />
}<br />
<br />
/**<br />
&nbsp;* @param Model_DTO_Video<br />
&nbsp;* @return Model_DTO_Video<br />
&nbsp;*/<br />
public function delete (Model_DTO_Video $poVideoDTO)<br />
{<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; = null;<br />
&nbsp; &nbsp; $oAssembler = new Model_Utils_Assembler ();<br />
&nbsp; &nbsp; $oModelVideo&nbsp; &nbsp; = $oAssembler-&amp;gt;createDomainObject($poVideoDTO, false);<br />
&nbsp; &nbsp; $oModelVideo-&amp;gt;delete ();<br />
&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; return $poVideoDTO;<br />
}</div></td></tr></tbody></table></div>
<h3>Téléchargement</h3>
<p>Contenu de l&#8217;archive :</p>
<ul>
<li>Implémentation du pattern Transfer Object Assembler</li>
<li>Interface du pattern Transfer Object Assembler</li>
<li>Classe de définition d&#8217;un DTO</li>
</ul>
<p>Pour faire fonctionner l&#8217;assembler. Vous devez définir une classe qui hérite de Assembler, et ainsi surchargez la propriété $_relationships avec vos liaisons entre DTO et DOM.</p>
<p><strong>Dernière mise à jour : 20 Septembre 2010</strong><br />
<a href='http://www.armetiz.info/wp-content/uploads/2010/09/Transfert_Object_Assembler_Doctrine_1.2.zip'>Transfert_Object_Assembler_Doctrine_1.2.zip</a> &#8211; 6 Ko.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.armetiz.info/transfer-object-assembler-avec-doctrine-1/feed/</wfw:commentRss>
		<slash:comments>7</slash:comments>
		</item>
	</channel>
</rss>

<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using apc
Database Caching 6/14 queries in 0.008 seconds using apc
Object Caching 873/896 objects using apc

 Served from: www.armetiz.info @ 2015-07-01 11:14:50 by W3 Total Cache -->
